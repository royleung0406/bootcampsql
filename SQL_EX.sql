CREATE DATABASE BOOTCAMP_EX;
USE BOOTCAMP_EX;

CREATE TABLE REGIONS (
	ID INTEGER PRIMARY KEY, -- UNQIUE, NOT NULL
	REGION_NAME VARCHAR(25)
);

CREATE TABLE JOBS (
	ID VARCHAR(10) PRIMARY KEY, -- UNQIUE, NOT NULL
	JOB_TITLE VARCHAR(35),
    MIN_SALARY INTEGER,
    MAX_SALARY INTEGER
    
);

CREATE TABLE COUNTRIES (
	ID INTEGER PRIMARY KEY, -- UNQIUE, NOT NULL
	COUNTRY_NAME VARCHAR(45),
    REGION_ID INTEGER,
    -- CUSTOMER_ID -> ORDERS.CUSTOMER_ID (CURRENT TABLE COLUMN)
    -- ID -> CUSTOMERS.ID (ANOTHER TABLE PK)
    FOREIGN KEY (REGION_ID) REFERENCES REGIONS(ID)
);

CREATE TABLE LOCATIONS (
	ID INTEGER PRIMARY KEY, -- UNQIUE, NOT NULL
	STREET_NAME VARCHAR(25),
	POSTAL_CODE VARCHAR(12),
    CITY VARCHAR(30),
    STATE_PROVINCE VARCHAR(12),
    COUNTRY_ID INTEGER,
    -- CUSTOMER_ID -> ORDERS.CUSTOMER_ID (CURRENT TABLE COLUMN)
    -- ID -> CUSTOMERS.ID (ANOTHER TABLE PK)
    FOREIGN KEY (COUNTRY_ID) REFERENCES COUNTRIES(ID)
);

CREATE TABLE DEPARTMENTS (
	ID INTEGER PRIMARY KEY, -- UNQIUE, NOT NULL
	DEPARTMENT_NAME VARCHAR(30),
    MANAGER_ID INTEGER,
    LOCATION_ID INTEGER,
    -- CUSTOMER_ID -> ORDERS.CUSTOMER_ID (CURRENT TABLE COLUMN)
    -- ID -> CUSTOMERS.ID (ANOTHER TABLE PK)
    FOREIGN KEY (LOCATION_ID) REFERENCES LOCATIONS(ID)
);

CREATE TABLE EMPLOYEES (
	ID INTEGER PRIMARY KEY, -- UNQIUE, NOT NULL
	FIRST_NAME VARCHAR(20),
    LAST_NAME VARCHAR(25),
    EMAIL VARCHAR(25),
    PHONE_NUMBER VARCHAR(20),
    HIRE_DATE DATE,
    JOB_ID VARCHAR(10),
    SALARY INTEGER,
    COMMISSION_PCT INTEGER,
    MANAGER_ID INTEGER,
    DEPARTMENT_ID INTEGER,
    -- CUSTOMER_ID -> ORDERS.CUSTOMER_ID (CURRENT TABLE COLUMN)
    -- ID -> CUSTOMERS.ID (ANOTHER TABLE PK)
    FOREIGN KEY (JOB_ID) REFERENCES JOBS(ID),
    FOREIGN KEY (DEPARTMENT_ID) REFERENCES DEPARTMENTS(ID)
);
CREATE TABLE JOB_HISTORY (
    EMPLOYEE_ID INTEGER,
    START_DATE DATE,
    PRIMARY KEY (EMPLOYEE_ID, START_DATE),
    END_DATE DATE,
    JOB_ID VARCHAR (10),
	DEPARTMENT_ID INTEGER,
    FOREIGN KEY (JOB_ID) REFERENCES JOBS(ID),
	FOREIGN KEY (DEPARTMENT_ID) REFERENCES DEPARTMENTS(ID),
    FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEES(ID)
);

INSERT INTO REGIONS (ID, REGION_NAME) 
	VALUES (1, 'ASIA');
INSERT INTO REGIONS (ID, REGION_NAME) 
	VALUES (2, 'NORTH AMERICA');
INSERT INTO REGIONS (ID, REGION_NAME) 
	VALUES (3, 'SOUTH AFRICA');
    
INSERT INTO JOBS (ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
	VALUES (1, 'IT', 18000, 70000);
INSERT INTO JOBS (ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
	VALUES (2, 'SALES', 28000, 100000);
INSERT INTO JOBS (ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
	VALUES (3, 'MARKETING', 13000, 40000); 
    
INSERT INTO Countries (ID, COUNTRY_NAME, REGION_ID)   
  VALUES (1,'HONG KONG', 1);
INSERT INTO Countries (ID, COUNTRY_NAME, REGION_ID)   
  VALUES (2,'USA', 2);
INSERT INTO Countries (ID, COUNTRY_NAME, REGION_ID)   
  VALUES (3,'CUBA', 3);
  
INSERT INTO LOCATIONS (ID, STREET_NAME, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID)   
  VALUES (1,'DIAMOND HILL', '+852', 'KOLWOON', 'HONK KONG', 1);  
INSERT INTO LOCATIONS (ID, STREET_NAME, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID)   
  VALUES (2,'RICHMOND', '+1', 'CHICAGO', 'NEW YORK', 2); 
INSERT INTO LOCATIONS (ID, STREET_NAME, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID)   
  VALUES (3,'SIU SHEN', '+873', 'CUBATO', 'TORO', 3);  
  
INSERT INTO DEPARTMENTS (ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID)   
  VALUES (1,'IT DEPARTMENT', 0001, 1);  
INSERT INTO DEPARTMENTS (ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID)   
  VALUES (2,'SALES DEPARTMENT', 0002, 2);  
INSERT INTO DEPARTMENTS (ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID)   
  VALUES (3,'MARKETING DEPARTMENT', 0003, 3);

INSERT INTO EMPLOYEES (ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)   
  VALUES (1,'VINCENT', 'CHAN', 'VINCENTC@GMAIL.COM', '+852 1234 5678', STR_TO_DATE('2023-01-01', '%Y-%m-%d'), 1, 70000, 140000, NULL, 1);  
INSERT INTO EMPLOYEES (ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)   
  VALUES (2,'ROY', 'LEUNG', 'RL@123.COM', '+1 56780000', STR_TO_DATE('2022-03-27', '%Y-%m-%d'), 2, 20000, 200000, NULL, 2);  
INSERT INTO EMPLOYEES (ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)   
  VALUES (3,'BO', 'HUI', 'BO@MKEXPERT.COM', '+873 34683468', STR_TO_DATE('2024-05-15', '%Y-%m-%d'), 3, 40000, 70000, NULL, 3);    
  
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)   
  VALUES (2, STR_TO_DATE('2021-01-01', '%Y-%m-%d'), STR_TO_DATE('2022-03-25', '%Y-%m-%d'), 1, 1); 

-- LAST QUESTION

CREATE TABLE JOBS_GRADES (
    GRADE_LEVEL VARCHAR(10) PRIMARY KEY, -- UNIQUE, NOT NULL
    GRADE_TITLE VARCHAR(35)

);

INSERT INTO JOBS_GRADES (GRADE_LEVEL, GRADE_TITLE)   
  VALUES ('0','CIO');

ALTER TABLE JOBS ADD GRADE_LEVEL VARCHAR(10);
ALTER TABLE JOBS ADD FOREIGN KEY (GRADE_LEVEL) REFERENCES JOBS_GRADES(GRADE_LEVEL);

UPDATE JOBS SET GRADE_LEVEL = '0'  WHERE ID = 1;

SELECT * FROM JOBS;